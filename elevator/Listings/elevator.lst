C51 COMPILER V9.57.0.0   ELEVATOR                                                          04/30/2021 11:16:16 PAGE 1   


C51 COMPILER V9.57.0.0, COMPILATION OF MODULE ELEVATOR
OBJECT MODULE PLACED IN .\Objects\elevator.obj
COMPILER INVOKED BY: D:\Keil uvision C51\install\C51\BIN\C51.EXE elevator.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND 
                    -PRINT(.\Listings\elevator.lst) TABS(2) OBJECT(.\Objects\elevator.obj)

line level    source

   1          #include "reg51.h"   //Â£∞ÊòéÂçïÁâáÊú∫ÂØÑÂ≠òÂô®
   2          #include "intrins.h" //‰ΩøÁî®‰ΩçÁßªÂáΩÊï∞
   3          
   4          #define uchar unsigned char 
   5          #define uint unsigned int 
   6          
   7          
   8          
   9          //ÊåâÈîÆÂØπÂ∫îÁöÑP1IOÂè£ÁöÑÁîµÂπ≥
  10          #define IN_1_1 0x11
  11          #define IN_1_2 0x21
  12          #define IN_1_3 0x41
  13          #define IN_1_4 0x81
  14          #define IN_2_1 0x12
  15          #define IN_2_2 0x22
  16          #define IN_2_3 0x42
  17          #define IN_2_4 0x82
  18          #define OUT_1_UP 0x14
  19          #define OUT_2_UP 0x24
  20          #define OUT_2_DOWN 0x44
  21          #define OUT_3_UP 0x84
  22          #define OUT_3_DOWN 0x18
  23          #define OUT_4_DOWN 0x28
  24          
  25          
  26          uchar liftUp1[4] = {0,0,0,0};    //1Âè∑‰∏äË°åËØ∑Ê±ÇÈòüÂàó
  27          uchar liftDown1[4] = {0,0,0,0};  //1Âè∑‰∏ãË°åËØ∑Ê±ÇÈòüÂàó
  28          uchar liftUp2[4] = {0,0,0,0};    //2Âè∑‰∏äË°åËØ∑Ê±ÇÈòüÂàó
  29          uchar liftDown2[4] = {0,0,0,0};  //2Âè∑‰∏ãË°åËØ∑Ê±ÇÈòüÂàó
  30          uchar liftUp[4] = {0,0,0,0};     //ÁîµÊ¢ØÂ§ñÈÉ®‰∏äË°åËØ∑Ê±Ç
  31          uchar liftDown[4] = {0,0,0,0};   //ÁîµÊ¢ØÂ§ñÈÉ®‰∏ãË°åËØ∑Ê±Ç
  32          uchar isUpHandled[4] = {0,0,0,0};   //Â§ñÈÉ®ËØ∑Ê±ÇÊòØÂê¶Ë¢´Â§ÑÁêÜÔºå1Ë°®Á§∫Ë¢´Â§ÑÁêÜ
  33          uchar isDownHandled[4] = {0,0,0,0}; //Â§ñÈÉ®ËØ∑Ê±ÇÊòØÂê¶Ë¢´Â§ÑÁêÜÔºå1Ë°®Á§∫Ë¢´Â§ÑÁêÜ
  34          uchar currentLevel1 = 1;         //1Âè∑ÁîµÊ¢ØÂΩìÂâçÊ•ºÂ±Ç 
  35          uchar currentLevel2 = 1;         //2Âè∑ÁîµÊ¢ØÂΩìÂâçÊ•ºÂ±Ç 
  36          uchar nextLevel1 = 1;            //1Âè∑ÁîµÊ¢Ø‰∏ã‰∏Ä‰∏™Ë¶ÅÂà∞ËææÁöÑÊ•ºÂ±Ç
  37          uchar nextLevel2 = 1;            //2Âè∑ÁîµÊ¢Ø‰∏ã‰∏Ä‰∏™Ë¶ÅÂà∞ËææÁöÑÊ•ºÂ±Ç
  38          
  39          bit DIR1 = 1;                    //1Âè∑ÊñπÂêë,1ÊòØÂêë‰∏ä,0ÊòØÂêë‰∏ã
  40          bit DIR2 = 1;                    //2Âè∑ÊñπÂêë,1ÊòØÂêë‰∏ä,0ÊòØÂêë‰∏ã
  41          bit IDLE1 = 1;                   //1Âè∑ÊòØÂê¶Á©∫Èó≤
  42          bit IDLE2 = 1;                   //2Âè∑ÊòØÂê¶Á©∫Èó≤
  43          bit STOP1 = 1;                   //1Âè∑ÊòØÂê¶ÂÅúÊ≠¢
  44          bit STOP2 = 1;                   //2Âè∑ÊòØÂê¶ÂÅúÊ≠¢
  45          uchar TIMER1 = 0;                //Áî®‰∫éÂÆöÊó∂1ÁßíÔºå20‰∏™Âë®ÊúüÂêéÂΩí0Ôºõ
  46          uchar TIMER2 = 0;                //Áî®‰∫éÂÆöÊó∂1ÁßíÔºå20‰∏™Âë®ÊúüÂêéÂΩí0Ôºõ
  47          
  48          //ÊéßÂà∂Êï∞Á†ÅÁÆ°ÁöÑIOÂè£
  49          sbit LED_1_1 = P0^0;
  50          sbit LED_1_2 = P0^1;
  51          sbit LED_2_1 = P0^2;
  52          sbit LED_2_2 = P0^3;
  53          
  54          
C51 COMPILER V9.57.0.0   ELEVATOR                                                          04/30/2021 11:16:16 PAGE 2   

  55          //ÊéßÂà∂ÁîµÊ¢ØÂÜÖÈÉ®LEDÁöÑIOÂè£
  56          sbit LED_IN_1_1 = P2^0;
  57          sbit LED_IN_1_2 = P2^1;
  58          sbit LED_IN_1_3 = P2^2;
  59          sbit LED_IN_1_4 = P2^3;
  60          sbit LED_IN_2_1 = P2^4;
  61          sbit LED_IN_2_2 = P2^5;
  62          sbit LED_IN_2_3 = P2^6;
  63          sbit LED_IN_2_4 = P2^7;
  64          //ÊéßÂà∂ÁîµÊ¢ØÂ§ñÈÉ®LEDÁöÑIOÂè£
  65          sbit UP1 = P3^0;
  66          sbit UP2 = P3^1;
  67          sbit UP3 = P3^2;
  68          sbit DOWN2 = P3^3;
  69          sbit DOWN3 = P3^4;
  70          sbit DOWN4 = P3^5;
  71          //ÊéßÂà∂ÊòæÁ§∫ÁîµÊ¢Ø‰∏ä‰∏ãLEDÁöÑIOÂè£
  72          sbit LIFT1UP = P0^4;
  73          sbit LIFT1DOWN = P0^5;
  74          sbit LIFT2UP = P0^6;
  75          sbit LIFT2DOWN = P0^7;
  76          //ÊéßÂà∂ÂºÄÈó®ÁöÑLEDÁöÑIOÂè£
  77          sbit OPEN1 = P3^6;
  78          sbit OPEN2 = P3^7;
  79          
  80          void init(){
  81   1          int i = 0;
  82   1          for(i=4; i>0; i--){
  83   2              liftUp1[i] = 0;
  84   2              liftDown1[i] = 0;
  85   2              liftUp2[i] = 0;
  86   2              liftDown2[i] = 0;
  87   2              liftUp[i] = 0;
  88   2              liftDown[i] = 0;
  89   2          }
  90   1          currentLevel1 = 1;         //1Âè∑ÁîµÊ¢ØÂΩìÂâçÊ•ºÂ±Ç 
  91   1          currentLevel2 = 1;         //2Âè∑ÁîµÊ¢ØÂΩìÂâçÊ•ºÂ±Ç 
  92   1          nextLevel1 = 1;            //1Âè∑ÁîµÊ¢Ø‰∏ã‰∏Ä‰∏™Ë¶ÅÂà∞ËææÁöÑÊ•ºÂ±Ç
  93   1          nextLevel2 = 1;            //2Âè∑ÁîµÊ¢Ø‰∏ã‰∏Ä‰∏™Ë¶ÅÂà∞ËææÁöÑÊ•ºÂ±Ç
  94   1      }
  95          
  96          /*
  97           *  ÂàùÂßãÂåñÂÆöÊó∂Âô® 
  98           */
  99          void initTimer(){
 100   1          TMOD = 0x01;
 101   1          TH0 = (65536-50000)/256; //ËÆæÁΩÆÂàùÂÄº‰∏∫50000us,50msÁöÑÈ´òÂõõ‰Ωç
 102   1          TL0 = (65536-50000)%256; //ËÆæÁΩÆÂàùÂÄº‰∏∫50000us,50msÁöÑ‰ΩéÂõõ‰Ωç
 103   1          ET0 = 1;                 //ÂºÄÂêØÂÆöÊó∂Âô®0ÁöÑ‰∏≠Êñ≠
 104   1          EA = 1;                  //ÂºÄÂêØÊÄª‰∏≠Êñ≠
 105   1          TR0 = 1;                 //ÂêØÂä®ÂÆöÊó∂Âô®0
 106   1          TIMER1 = 0;
 107   1      }
 108          
 109          /*
 110           *  Âª∂Ëøü
 111           */
 112          void delay(uint time){
 113   1          int i=0,j=0;
 114   1          for(i=time; i>0; i--){
 115   2              for(j=120;j>0;j--){
 116   3      
C51 COMPILER V9.57.0.0   ELEVATOR                                                          04/30/2021 11:16:16 PAGE 3   

 117   3              }
 118   2          }
 119   1      }
 120          /*
 121           *  Âª∂Ëøü1Áßí
 122           */
 123          void delay1s(){
 124   1        int i=0, j=0;
 125   1          for(i=120; i>0; i--){
 126   2              for(j=1000; j>0; j--){
 127   3      
 128   3              }
 129   2          }
 130   1      }
 131          
 132          /*
 133           *  Âª∂Ëøü20ÊØ´Áßí
 134           */
 135          void delay20ms(){
 136   1        int i=0;
 137   1          for(i=2400; i>0; i--){
 138   2      
 139   2          }
 140   1      }
 141          
 142          /*
 143           *  Âª∂Ëøü0.5Áßí,Ê®°ÊãüÁîµÊ¢Ø‰∏äÂçá
 144           */
 145          void delay500ms(){
 146   1        int i=0, j=0;
 147   1          for(i=120; i>0; i--){
 148   2              for(j=500; j>0; j--){
 149   3      
 150   3              }
 151   2          }
 152   1      }
 153          
 154          /*
 155           *  Áî®‰∫éÊâ´ÊèèÁü©ÈòµÈîÆÁõò,Ëé∑ÂèñË¢´Êåâ‰∏ãÁöÑÊåâÈíÆ‰ø°ÊÅØ
 156           */
 157          uchar keyboardScan(){
 158   1        uchar keyResult = 0x00;
 159   1        uchar highEnd = 0x00;
 160   1        uchar lowEnd = 0x00;
 161   1          P1 = 0xf0;   //ÂàùÂßãÂåñP1ÁöÑÂÖ´‰∏™Âè£ÔºåÂâçÂõõ‰∏™ÁΩÆ‰∏∫È´òÁîµÂπ≥ÔºåÂêéÂõõ‰∏™ÁΩÆ‰∏∫‰ΩéÁîµÂπ≥
 162   1          if((P1 & 0xf0) != 0xf0){  //Â¶ÇÊûúP1ÁöÑÈ´òÂõõ‰Ωç‰∏çÂÖ®‰∏∫1ÔºåËØ¥ÊòéÊúâÈîÆÊåâ‰∏ã
 163   2              delay20ms();  //Âª∂Êó∂ÂéªÊäñÂä®
 164   2              if((P1 & 0xf0) != 0xf0){  //ÊåâÈíÆÁ°ÆÂÆûË¢´Êåâ‰∏ã
 165   3                  highEnd = P1 ^ 0xf0;
 166   3                  P1 = 0x0f;
 167   3                  lowEnd = P1 ^ 0x0f;
 168   3                  return highEnd | lowEnd;
 169   3              }
 170   2          }
 171   1          return 0x00;
 172   1      }
 173          
 174          
 175          uchar sum(uchar level[]){
 176   1          int i=0;
 177   1          uchar levels = 0;
 178   1          for(i=4; i>0; i--){
C51 COMPILER V9.57.0.0   ELEVATOR                                                          04/30/2021 11:16:16 PAGE 4   

 179   2              levels += level[i-1];
 180   2          }
 181   1          return levels;
 182   1      }
 183          
 184          /*
 185           *  ÊåâÈîÆÂ§ÑÁêÜ‰∫ã‰ª∂
 186           */
 187          void keyProcess(){
 188   1          uchar key = keyboardScan();
 189   1          switch (key)
 190   1          {
 191   2          case IN_1_1:
 192   2              if(currentLevel1 > 1){
 193   3                  liftDown1[0] = 1;
 194   3              }
 195   2              //LED_IN_1_1 = 0;
 196   2              break;
 197   2          case IN_1_2:
 198   2              if(currentLevel1 > 2){
 199   3                  liftDown1[1] = 1;
 200   3              }else if (currentLevel1 < 2){
 201   3                  liftUp1[1] = 1; 
 202   3              }
 203   2              //LED_IN_1_2 = 0;
 204   2              break;
 205   2          case IN_1_3:
 206   2              if(currentLevel1 > 3){
 207   3                  liftDown1[2] = 1;
 208   3              }else if (currentLevel1 < 3){
 209   3                  liftUp1[2] = 1; 
 210   3              }
 211   2              //LED_IN_1_3 = 0;
 212   2              break;
 213   2          case IN_1_4:
 214   2              if (currentLevel1 < 4){
 215   3                  liftUp1[3] = 1; 
 216   3              }
 217   2              //LED_IN_1_4 = 0;
 218   2              break;
 219   2          case IN_2_1:
 220   2              if(currentLevel2 > 1){
 221   3                  liftDown2[0] = 1;
 222   3              }
 223   2              //LED_IN_2_1 = 0;
 224   2              break;
 225   2          case IN_2_2:
 226   2              if(currentLevel2 > 2){
 227   3                  liftDown2[1] = 1;
 228   3              }else if (currentLevel2 < 2){ 
 229   3                  liftUp2[1] = 1;
 230   3              }
 231   2              //LED_IN_2_2 = 0;
 232   2              break;
 233   2          case IN_2_3:
 234   2              if(currentLevel2 > 3){
 235   3                  liftDown2[2] = 1;
 236   3              }else if (currentLevel2 < 3){ 
 237   3                  liftUp2[2] = 1;
 238   3              }
 239   2              //LED_IN_2_3 = 0;
 240   2              break;
C51 COMPILER V9.57.0.0   ELEVATOR                                                          04/30/2021 11:16:16 PAGE 5   

 241   2          case IN_2_4:
 242   2              if (currentLevel2 < 4){ 
 243   3                  liftUp2[3] = 1;
 244   3              }
 245   2              //LED_IN_2_4 = 0;
 246   2              break;
 247   2      
 248   2      
 249   2          case OUT_1_UP:
 250   2              //if(nextLevel1 != 1 & nextLevel2 != 1){
 251   2                  liftUp[0] = 1;
 252   2              //}
 253   2              break;
 254   2      
 255   2      
 256   2          case OUT_2_DOWN:
 257   2              //if(!(!DIR1 & nextLevel1 == 2) & !(!DIR2 & nextLevel2 == 2)){
 258   2                  liftDown[1] = 1;
 259   2              //}
 260   2              break;
 261   2      
 262   2      
 263   2          case OUT_2_UP:
 264   2              //if(!(DIR1 & nextLevel1 == 2) & !(DIR2 & nextLevel2 == 2)){
 265   2                  liftUp[1] = 1;
 266   2              //}
 267   2              break;
 268   2          case OUT_3_DOWN:
 269   2              //if(!(!DIR1 & nextLevel1 == 3) & !(!DIR2 & nextLevel2 == 3)){
 270   2                  liftDown[2] = 1;
 271   2              //}
 272   2              break;
 273   2          case OUT_3_UP:
 274   2              //if(!(DIR1 & nextLevel1 == 3) & !(DIR2 & nextLevel2 == 3)){
 275   2                  liftUp[2] = 1;
 276   2              //}
 277   2              break;
 278   2          case OUT_4_DOWN:
 279   2              //if(nextLevel1 != 4 & nextLevel2 != 4){
 280   2                  liftDown[3] = 1;
 281   2              //}
 282   2              break;
 283   2          default:
 284   2              break;
 285   2          }
 286   1      }
 287          
 288          /*
 289           *  ÊòæÁ§∫Ê•ºÂ±Ç
 290           */
 291          void display(){
 292   1          int i = 0;
 293   1          switch (currentLevel1)
 294   1          {
 295   2          case 1:
 296   2              LED_1_1 = 0;
 297   2              LED_1_2 = 0;
 298   2              break;
 299   2          case 2:
 300   2              LED_1_1 = 1;
 301   2              LED_1_2 = 0;
 302   2              break;
C51 COMPILER V9.57.0.0   ELEVATOR                                                          04/30/2021 11:16:16 PAGE 6   

 303   2          case 3:
 304   2              LED_1_1 = 0;
 305   2              LED_1_2 = 1;
 306   2              break;
 307   2          case 4:
 308   2              LED_1_1 = 1;
 309   2              LED_1_2 = 1;
 310   2              break;
 311   2          default:
 312   2              break;
 313   2          }
 314   1      
 315   1          switch (currentLevel2)
 316   1          {
 317   2          case 1:
 318   2              LED_2_1 = 0;
 319   2              LED_2_2 = 0;
 320   2              break;
 321   2          case 2:
 322   2              LED_2_1 = 1;
 323   2              LED_2_2 = 0;
 324   2              break;
 325   2          case 3:
 326   2              LED_2_1 = 0;
 327   2              LED_2_2 = 1;
 328   2              break;
 329   2          case 4:
 330   2              LED_2_1 = 1;
 331   2              LED_2_2 = 1;
 332   2              break;
 333   2          default:
 334   2              break;
 335   2          }
 336   1          LED_IN_1_1 = !(liftUp1[0] | liftDown1[0]);
 337   1          LED_IN_1_2 = !(liftUp1[1] | liftDown1[1]);
 338   1          LED_IN_1_3 = !(liftUp1[2] | liftDown1[2]);
 339   1          LED_IN_1_4 = !(liftUp1[3] | liftDown1[3]);
 340   1          LED_IN_2_1 = !(liftUp2[0] | liftDown2[0]);
 341   1          LED_IN_2_2 = !(liftUp2[1] | liftDown2[1]);
 342   1          LED_IN_2_3 = !(liftUp2[2] | liftDown2[2]);
 343   1          LED_IN_2_4 = !(liftUp2[3] | liftDown2[3]);
 344   1          UP1 = !liftUp[0];
 345   1          UP2 = !liftUp[1];
 346   1          UP3 = !liftUp[2];
 347   1          DOWN2 = !liftDown[1];
 348   1          DOWN3 = !liftDown[2];
 349   1          DOWN4 = !liftDown[3];
 350   1          LIFT1UP = !(sum(liftUp1) == 0);
 351   1          LIFT2UP = !(sum(liftDown1) == 0);
 352   1          LIFT1DOWN = !(sum(liftUp) == 0);
 353   1          LIFT2DOWN = !(sum(liftDown) == 0);
 354   1          if(STOP1 & !IDLE1){
 355   2              OPEN1 = 0;
 356   2          }else{
 357   2              OPEN1 = 1;
 358   2          }
 359   1          
 360   1          if(STOP2 & !IDLE2){
 361   2              OPEN2 = 0;
 362   2          }else{
 363   2              OPEN2 = 1;
 364   2          }
C51 COMPILER V9.57.0.0   ELEVATOR                                                          04/30/2021 11:16:16 PAGE 7   

 365   1      }
 366          
 367          /*
 368           *  ÂÆöÊó∂Âô®1‰∏≠Êñ≠ÂáΩÊï∞
 369           */
 370          void timerIsr() interrupt 1{
 371   1          if(TIMER1 <= 20){
 372   2              TH0 = (65536-50000)/256; //ËÆæÁΩÆÂàùÂÄº‰∏∫50000us,50msÁöÑÈ´òÂõõ‰Ωç
 373   2              TL0 = (65536-50000)%256; //ËÆæÁΩÆÂàùÂÄº‰∏∫50000us,50msÁöÑ‰ΩéÂõõ‰Ωç
 374   2              TIMER1 ++;
 375   2              if(TIMER1 == 20){
 376   3                  display();
 377   3              }
 378   2          }
 379   1      }
 380          
 381          /*
 382           *  Âéª‰∏ã‰∏ÄÂ±Ç
 383           */
 384          void gotoNextLevel1(){
 385   1          if(nextLevel1 == currentLevel1){
 386   2              int j = 0;
 387   2              if(DIR1){
 388   3                  if(liftUp[currentLevel1-1] == 1){
 389   4                      STOP1 = 1;
 390   4                      IDLE1 = 0;
 391   4                      liftUp1[currentLevel1-1] = 0;
 392   4                      liftUp[currentLevel1-1] = 0;
 393   4                      for(j=70;j>0;j--){
 394   5                          delay20ms();
 395   5                          keyProcess();
 396   5                          display();
 397   5                      }
 398   4                      //IDLE1 = 1;
 399   4                      STOP1 = 0;
 400   4                  }
 401   3              }else{
 402   3                  if(liftDown[currentLevel1-1] == 1){
 403   4                      STOP1 = 1;
 404   4                      IDLE1 = 0;
 405   4                      liftDown1[currentLevel1-1] = 0;
 406   4                      liftDown[currentLevel1-1] = 0;
 407   4                      for(j=70;j>0;j--){
 408   5                          delay20ms();
 409   5                          keyProcess();
 410   5                          display();
 411   5                      }
 412   4                      //IDLE1 = 1;
 413   4                      STOP1 = 0;
 414   4                  }
 415   3              }
 416   2          }
 417   1      
 418   1          if(nextLevel1 > currentLevel1){
 419   2              int i=0,j=0;
 420   2              DIR1 = 1;
 421   2              IDLE1 = 0;
 422   2              //LED_IN_1_4 = 0;
 423   2              STOP1 = 0;
 424   2              for(i=35;i>0;i--){
 425   3                  delay20ms();
 426   3                  keyProcess();
C51 COMPILER V9.57.0.0   ELEVATOR                                                          04/30/2021 11:16:16 PAGE 8   

 427   3                  display();
 428   3              }
 429   2              currentLevel1++;
 430   2              liftUp1[currentLevel1-1] = 0;
 431   2              liftUp[currentLevel1-1] = 0;
 432   2              display();
 433   2              if(currentLevel1 == nextLevel1){
 434   3                  STOP1 = 1;
 435   3                  for(j=70;j>0;j--){
 436   4                      delay20ms();
 437   4                      keyProcess();
 438   4                      display();
 439   4                  }
 440   3                  STOP1 = 0;
 441   3                  //ÂΩìÊâÄÂÜÖÂ§ñÈÉ®ÈÉΩÊ≤°ÊúâËØ∑Ê±ÇÁöÑÊó∂ÂÄôÔºåÁîµÊ¢ØÈó≤ÁΩÆ
 442   3                  if((sum(liftUp1) == 0) & (sum(liftDown1) == 0) & (sum(liftUp) == 0) & (sum(liftDown) == 0)){
 443   4                      IDLE1 = 1;
 444   4                  } 
 445   3              }
 446   2              return;
 447   2          }
 448   1      
 449   1          if(nextLevel1 < currentLevel1){
 450   2              int i=0,j=0;
 451   2              DIR1 = 0;
 452   2              IDLE1 = 0;
 453   2              STOP1 = 0;
 454   2              for(i=35;i>0;i--){
 455   3                  delay20ms();
 456   3                  keyProcess();
 457   3                  display();
 458   3              }
 459   2              currentLevel1--;
 460   2              liftDown1[currentLevel1-1] = 0;
 461   2              liftDown[currentLevel1-1] = 0;
 462   2              display();
 463   2              if(currentLevel1 == nextLevel1){
 464   3                  STOP1 = 1;
 465   3                  for(j=70;j>0;j--){
 466   4                      delay20ms();
 467   4                      keyProcess();
 468   4                      display();
 469   4                  }
 470   3                  STOP1 = 0;
 471   3                  //ÂΩìÊâÄÂÜÖÂ§ñÈÉ®ÈÉΩÊ≤°ÊúâËØ∑Ê±ÇÁöÑÊó∂ÂÄôÔºåÁîµÊ¢ØÈó≤ÁΩÆ
 472   3                  if((sum(liftUp1) == 0) & (sum(liftDown1) == 0) & (sum(liftUp) == 0) & (sum(liftDown) == 0)){
 473   4                      IDLE1 = 1;
 474   4                  }
 475   3              }
 476   2              return;
 477   2          }
 478   1      }
 479          
 480          /*
 481           *  1Âè∑ÁîµÊ¢ØÂ∑•‰Ωú
 482           */
 483          void work1(){
 484   1          //ÁîµÊ¢ØÁ©∫Èó≤Â∞±‰ºöËá™Âä®Êâ´ÊèèÂ§ñÈÉ®ËØ∑Ê±Ç
 485   1          if(IDLE1){
 486   2              if(DIR1){
 487   3                  uchar temp = currentLevel1;
 488   3                  //LIFT1UP = 1;
C51 COMPILER V9.57.0.0   ELEVATOR                                                          04/30/2021 11:16:16 PAGE 9   

 489   3                  while(temp > 0 && !(liftUp[temp-1] | liftDown[temp-1])){
 490   4                      temp--;
 491   4                  }
 492   3                  if(temp > 0){
 493   4                      if(nextLevel2 != temp){
 494   5                          nextLevel1 = temp;
 495   5                          //LIFT1UP = 0;
 496   5                          //DIR1 = 0;
 497   5                      }
 498   4                  }
 499   3              }else{
 500   3                  uchar temp = currentLevel1;
 501   3                  while(temp < 5 && !(liftUp[temp-1] | liftDown[temp-1])){
 502   4                      temp++;
 503   4                  }
 504   3                  if(temp < 5){
 505   4                      if(nextLevel2 != temp){
 506   5                          nextLevel1 = temp;
 507   5                          //DIR1 = 1;
 508   5                      }
 509   4                  }
 510   3              }
 511   2          }
 512   1          //ÁîµÊ¢ØÊñπÂêëÂêë‰∏ä
 513   1          if(DIR1){
 514   2              uchar temp = currentLevel1;
 515   2              //ÈóÆÈ¢òÂá∫Âú®ËøôÈáå   temp‰ªécurrentlevelÂºÄÂßãÔºåÈÇ£‰πàÂ§ñÈÉ®ÁöÑ‰Ωé‰∫écurrentLevelÁöÑËØ∑Ê±ÇÊó†Ê≥
             -ïÂ§ÑÁêÜ
 516   2              while ((temp < 5) && !(liftUp1[temp-1] | (liftUp[temp-1] & !(DIR1 & nextLevel2 == temp)))){       
             -   //ÂΩìÊúâÁîµÊ¢ØÂÜÖÈÉ®ËØ∑Ê±ÇÔºåÊàñÊúâÂè¶‰∏ÄÈÉ®ÁîµÊ¢ØÊú™ÂìçÂ∫îÁöÑÂ§ñÈÉ®ËØ∑Ê±ÇÔºåÂàôÂìçÂ∫î
 517   3                  temp++;
 518   3              }
 519   2              if(temp < 5){
 520   3                  nextLevel1 = temp;
 521   3                  //Ë°®Á§∫Â§ñÈÉ®ËØ∑Ê±ÇÂ∑≤Ë¢´Â§ÑÁêÜ
 522   3                  //liftUp[temp-1] = 0;
 523   3              }else{
 524   3                  DIR1 = 0;
 525   3              }
 526   2          }else{
 527   2              uchar temp = currentLevel1;
 528   2              while ((temp > 0) && !(liftDown1[temp-1] | (liftDown[temp-1] & !(!DIR1 & nextLevel2 == temp)))){
 529   3                  temp--;
 530   3              }
 531   2              if(temp > 0){
 532   3                  nextLevel1 = temp;
 533   3                  //Ë°®Á§∫Â§ñÈÉ®ËØ∑Ê±ÇÂ∑≤Ë¢´Â§ÑÁêÜ
 534   3                  //liftDown[temp-1] = 0;
 535   3              }else{
 536   3                  DIR1 = 1;   
 537   3              }
 538   2          }
 539   1          gotoNextLevel1();
 540   1      }
 541          
 542          
 543          /*
 544           *  Âéª‰∏ã‰∏ÄÂ±Ç
 545           */
 546          void gotoNextLevel2(){
 547   1          if(nextLevel2 == currentLevel2){
 548   2              int j = 0;
C51 COMPILER V9.57.0.0   ELEVATOR                                                          04/30/2021 11:16:16 PAGE 10  

 549   2              if(DIR2){
 550   3                  if(liftUp[currentLevel2-1] == 1){
 551   4                      STOP2 = 1;
 552   4                      IDLE2 = 0;
 553   4                      liftUp2[currentLevel2-1] = 0;
 554   4                      liftUp[currentLevel2-1] = 0;
 555   4                      for(j=70;j>0;j--){
 556   5                          delay20ms();
 557   5                          keyProcess();
 558   5                          display();
 559   5                      }
 560   4                      //IDLE2 = 1;
 561   4                      STOP2 = 0;
 562   4                  }
 563   3              }else{
 564   3                  if(liftDown[currentLevel2-1] == 1){
 565   4                      STOP2 = 1;
 566   4                      IDLE2 = 0;
 567   4                      liftDown2[currentLevel2-1] = 0;
 568   4                      liftDown[currentLevel2-1] = 0;
 569   4                      for(j=70;j>0;j--){
 570   5                          delay20ms();
 571   5                          keyProcess();
 572   5                          display();
 573   5                      }
 574   4                      //IDLE2 = 1;
 575   4                      STOP2 = 0;
 576   4                  }
 577   3              }
 578   2          }
 579   1      
 580   1          if(nextLevel2 > currentLevel2){
 581   2              int i=0,j=0;
 582   2              //LED_IN_1_4 = 0;
 583   2              DIR2 = 1;
 584   2              IDLE2 = 0;
 585   2              STOP2 = 0;
 586   2              for(i=35;i>0;i--){
 587   3                  delay20ms();
 588   3                  keyProcess();
 589   3                  display();
 590   3              }
 591   2              currentLevel2++;
 592   2              liftUp2[currentLevel2-1] = 0;
 593   2              liftUp[currentLevel2-1] = 0;
 594   2              display();
 595   2              if(currentLevel2 == nextLevel2){
 596   3                  STOP2 = 1;
 597   3                  for(j=70;j>0;j--){
 598   4                      delay20ms();
 599   4                      keyProcess();
 600   4                      display();
 601   4                  }
 602   3                  STOP2 = 0;
 603   3                  //ÂΩìÊâÄÂÜÖÂ§ñÈÉ®ÈÉΩÊ≤°ÊúâËØ∑Ê±ÇÁöÑÊó∂ÂÄôÔºåÁîµÊ¢ØÈó≤ÁΩÆ
 604   3                  if((sum(liftUp2) == 0) & (sum(liftDown2) == 0) & (sum(liftUp) == 0) & (sum(liftDown) == 0)){
 605   4                      IDLE2 = 1;
 606   4                  } 
 607   3              }
 608   2              return;
 609   2          }
 610   1      
C51 COMPILER V9.57.0.0   ELEVATOR                                                          04/30/2021 11:16:16 PAGE 11  

 611   1          if(nextLevel2 < currentLevel2){
 612   2              int i=0,j=0;
 613   2              DIR2 = 0;
 614   2              IDLE2 = 0;
 615   2              STOP2 = 0;
 616   2              for(i=35;i>0;i--){
 617   3                  delay20ms();
 618   3                  keyProcess();
 619   3                  display();
 620   3              }
 621   2              currentLevel2--;
 622   2              liftDown2[currentLevel2-1] = 0;
 623   2              liftDown[currentLevel2-1] = 0;
 624   2              display();
 625   2              if(currentLevel2 == nextLevel2){
 626   3                  STOP2 = 1;
 627   3                  for(j=70;j>0;j--){
 628   4                      delay20ms();
 629   4                      keyProcess();
 630   4                      display();
 631   4                  }
 632   3                  STOP2 = 0;
 633   3                  //ÂΩìÊâÄÂÜÖÂ§ñÈÉ®ÈÉΩÊ≤°ÊúâËØ∑Ê±ÇÁöÑÊó∂ÂÄôÔºåÁîµÊ¢ØÈó≤ÁΩÆ
 634   3                  if((sum(liftUp2) == 0) & (sum(liftDown2) == 0) & (sum(liftUp) == 0) & (sum(liftDown) == 0)){
 635   4                      IDLE2 = 1;
 636   4                  } 
 637   3              }
 638   2              return;
 639   2          }
 640   1      }
 641          
 642          /*
 643           *  1Âè∑ÁîµÊ¢ØÂ∑•‰Ωú
 644           */
 645          void work2(){
 646   1          //ÁîµÊ¢ØÁ©∫Èó≤Â∞±‰ºöËá™Âä®Êâ´ÊèèÂ§ñÈÉ®ËØ∑Ê±Ç
 647   1          if(IDLE2){
 648   2              if(DIR2){
 649   3                  uchar temp = currentLevel2;
 650   3                  //LIFT1UP = 1;
 651   3                  while(temp > 0 && !(liftUp[temp-1] | liftDown[temp-1])){
 652   4                      temp--;
 653   4                  }
 654   3                  if(temp > 0){
 655   4                      if(nextLevel1 != temp){
 656   5                          nextLevel2 = temp;
 657   5                          //LIFT1UP = 0;
 658   5                          //DIR2 = 0;
 659   5                      }
 660   4                  }
 661   3              }else{
 662   3                  uchar temp = currentLevel2;
 663   3                  while(temp < 5 && !(liftUp[temp-1] | liftDown[temp-1])){
 664   4                      temp++;
 665   4                  }
 666   3                  if(temp < 5){
 667   4                      if(nextLevel1 != temp){
 668   5                          nextLevel2 = temp;
 669   5                          //DIR2 = 1;
 670   5                      }
 671   4                  }
 672   3              }
C51 COMPILER V9.57.0.0   ELEVATOR                                                          04/30/2021 11:16:16 PAGE 12  

 673   2          }
 674   1          //ÁîµÊ¢ØÊñπÂêëÂêë‰∏ä
 675   1          if(DIR2){
 676   2              uchar temp = currentLevel2;
 677   2              while ((temp < 5) && !(liftUp2[temp-1] | (liftUp[temp-1] & !(DIR2 & nextLevel1 == temp)))){
 678   3                  temp++;
 679   3              }
 680   2              if(temp < 5){
 681   3                  nextLevel2 = temp;
 682   3                  //Ë°®Á§∫Â§ñÈÉ®ËØ∑Ê±ÇÂ∑≤Ë¢´Â§ÑÁêÜ
 683   3                  //liftUp[temp-1] = 0;
 684   3              }else{
 685   3                  DIR2 = 0;
 686   3              }
 687   2          }else{
 688   2              uchar temp = currentLevel2;
 689   2              while ((temp > 0) && !(liftDown2[temp-1] | (liftDown[temp-1] & !(!DIR2 & nextLevel1 == temp)))){
 690   3                  temp--;
 691   3              }
 692   2              if(temp > 0){
 693   3                  nextLevel2 = temp;
 694   3                  //Ë°®Á§∫Â§ñÈÉ®ËØ∑Ê±ÇÂ∑≤Ë¢´Â§ÑÁêÜ
 695   3                  //liftDown[temp-1] = 0;
 696   3              }else{
 697   3                  DIR2 = 1;   
 698   3              }
 699   2          }
 700   1          gotoNextLevel2();
 701   1      }
 702          
 703          void word(){
 704   1          work1();
 705   1          work2();
 706   1      }
 707          
 708          void main(){
 709   1          //init();
 710   1        while(1){
 711   2              P1 = 0xf0;
 712   2              keyProcess();
 713   2              display();
 714   2              work1();
 715   2              work2();
 716   2          }
 717   1      }
 718          
 719                  // if(DIR1 & DIR2){                            //‰∏§Âè∞ÁîµÊ¢ØÈÉΩÂêë‰∏äÔºåÈÄâÊã©Âêë‰∏äÂÅúÈù†Ê¨°Êï∞Ê
             -úÄÂ∞ëÁöÑÁîµÊ¢Ø
 720                  //     if(sum(liftUp2) > sum(liftUp1)){
 721                  //         liftUp2[0] = 1;
 722                  //     }else{
 723                  //         liftUp1[0] = 1;
 724                  //     }
 725                  // }else if (!DIR1 & DIR2){                    //Â¶ÇÊûúÁîµÊ¢Ø1Âêë‰∏ãÔºåÁîµÊ¢Ø2Âêë‰∏äÔºåÈÄâÊã©ÁîµÊ¢
             -Ø1
 726                  //     liftUp1[0] = 1;
 727                  // }else if (DIR1 & !DIR2){                    //Â¶ÇÊûúÁîµÊ¢Ø2Âêë‰∏ãÔºåÁîµÊ¢Ø1Âêë‰∏äÔºåÈÄâÊã©ÁîµÊ¢
             -Ø2
 728                  //     liftUp2[0] = 1;
 729                  // }else{                                      //Â¶ÇÊûú‰∏§Êù°ÁîµÊ¢ØÈÉΩ‰∏ãÈôçÔºåÈÄâÊã©ÊúÄËøëÁöÑ‰∏ÄÂ
             -è∞
 730                  //     if(currentLevel2 > currentLevel1){
C51 COMPILER V9.57.0.0   ELEVATOR                                                          04/30/2021 11:16:16 PAGE 13  

 731                  //         liftUp2[0] = 1;
 732                  //     }else{
 733                  //         liftUp1[0] = 1;
 734                  //     }
 735                  // }
 736          
 737                  // if(DIR1 & DIR2){                            //‰∏§Âè∞ÁîµÊ¢ØÈÉΩÂêë‰∏äÔºåÈÄâÊã©Âêë‰∏äÂÅúÈù†Ê¨°Êï∞Ê
             -úÄÂ∞ëÁöÑÁîµÊ¢Ø
 738                  //     if(sum(liftUp2) > sum(liftUp1)){
 739                  //         liftDown2[1] = 1;
 740                  //     }else{
 741                  //         liftDown1[1] = 1;
 742                  //     }
 743                  // }else if (!DIR1 & DIR2){                    //Â¶ÇÊûúÁîµÊ¢Ø1Âêë‰∏ãÔºåÁîµÊ¢Ø2Âêë‰∏äÔºå
 744                  //     if(currentLevel1 >= 2){                 //Â¶ÇÊûúÁîµÊ¢Ø1ÂΩìÂâçÊ•ºÂ±ÇÂ§ß‰∫éÁ≠â‰∫é2ÔºåÈÄâÊã©Áî
             -µÊ¢Ø1
 745                  //         liftDown1[1] = 1;
 746                  //     }else{                                  //Âê¶ÂàôÈÄâÊã©ÁîµÊ¢Ø2
 747                  //         liftDown2[1] = 1;
 748                  //     }
 749                  // }else if (DIR1 & !DIR2){                    //Â¶ÇÊûúÁîµÊ¢Ø2Âêë‰∏ãÔºåÁîµÊ¢Ø1Âêë‰∏äÔºå
 750                  //     if(currentLevel2 >= 2){                 //Â¶ÇÊûúÁîµÊ¢Ø2ÂΩìÂâçÊ•ºÂ±ÇÂ§ß‰∫éÁ≠â‰∫é2ÔºåÈÄâÊã©Áî
             -µÊ¢Ø2
 751                  //         liftDown2[1] = 1;
 752                  //     }else{                                  //Âê¶ÂàôÈÄâÊã©ÁîµÊ¢Ø1
 753                  //         liftDown1[1] = 1;
 754                  //     }
 755                  // }else{                                      //Â¶ÇÊûú‰∏§Âè∞ÁîµÊ¢ØÈÉΩ‰∏ãÈôçÔºå
 756                  //     if(currentLevel1 >= 2 & currentLevel2 >= 2){   //Â¶ÇÊûú‰∏§Âè∞ÁîµÊ¢ØÁöÑÈ´òÂ∫¶ÈÉΩÂ§ß‰∫éÁ≠â‰∫é
             -2ÔºåÈÄâÊã©ËøëÁöÑ
 757                  //         if(currentLevel2 > currentLevel1){
 758                  //             liftDown2[1] = 1; 
 759                  //         }else{
 760                  //             liftDown1[1] = 1;
 761                  //         }
 762                  //     }else if(currentLevel1 >= 2){           //Âè™ÊúâÁ¨¨1ÈÉ®ÁîµÊ¢ØÂ§ß‰∫é2Â±ÇÈÄâÊã©ÁîµÊ¢Ø1
 763                  //         liftDown1[1] = 1;
 764                  //     }else if(currentLevel2 >= 2){           //Âè™ÊúâÁ¨¨2ÈÉ®ÁîµÊ¢ØÂ§ß‰∫é2Â±ÇÈÄâÊã©ÁîµÊ¢Ø2
 765                  //         liftDown2[1] = 1; 
 766                  //     }else{                                  //Âê¶ÂàôÈÄâÊã©Âêë‰∏äÂÅúÈù†ÊúÄÂ∞ëÁöÑÁîµÊ¢Ø
 767                  //         if(sum(liftUp2) > sum(liftUp1)){
 768                  //             liftDown2[1] = 1;
 769                  //         }else{
 770                  //             liftDown1[1] = 1;
 771                  //         }
 772                  //     }
 773                  // }
 774          
 775          
 776                  // if(DIR1 & DIR2){                            //‰∏§Âè∞ÁîµÊ¢ØÈÉΩÂêë‰∏ä
 777                  //     if(currentLevel1 <= 2 & currentLevel2 <= 2){  //‰∏§Âè∞ÁîµÊ¢ØÈÉΩÂú®2Ê•º‰ª•‰∏ãÔºåÈÄâÊã©ÊúÄËøë
             -ÁöÑÁîµÊ¢Ø
 778                  //         if(currentLevel2 > currentLevel1){  
 779                  //             liftUp2[1] = 1;
 780                  //         }else{
 781                  //             liftUp1[1] = 1;
 782                  //         }
 783                  //     }else if(currentLevel1 <= 2){            //Âè™Êúâ1Âè∑ÁîµÊ¢ØÂú®2Ê•º‰ª•‰∏ãÔºåÈÄâÊã©1Âè∑
 784                  //         liftUp1[1] = 1;
 785                  //     }else if(currentLevel2 <= 2){            //Âè™Êúâ2Âè∑ÁîµÊ¢ØÂú®2Ê•º‰ª•‰∏ãÔºåÈÄâÊã©2Âè∑
 786                  //         liftUp2[1] = 1;
 787                  //     }else{                                   //‰∏§Âè∞ÁîµÊ¢ØÈÉΩÂú®2Ê•º‰ª•‰∏äÔºåÈÄâÊã©Âêë‰∏äÂíåÂê
C51 COMPILER V9.57.0.0   ELEVATOR                                                          04/30/2021 11:16:16 PAGE 14  

             -ë‰∏ã
 788                  //         if(sum(liftUp2) > sum(liftUp1)){
 789                  //             liftUp2[0] = 1;
 790                  //         }else{
 791                  //             liftUp1[0] = 1;
 792                  //         }
 793                  //     }
 794                  // }else if (!DIR1 & DIR2){                    //Â¶ÇÊûúÁîµÊ¢Ø1Âêë‰∏ãÔºåÁîµÊ¢Ø2Âêë‰∏äÔºåÈÄâÊã©ÁîµÊ¢
             -Ø1
 795                  //     liftUp1[0] = 1;
 796                  // }else if (DIR1 & !DIR2){                    //Â¶ÇÊûúÁîµÊ¢Ø2Âêë‰∏ãÔºåÁîµÊ¢Ø1Âêë‰∏äÔºåÈÄâÊã©ÁîµÊ¢
             -Ø2
 797                  //     liftUp2[0] = 1;
 798                  // }else{                                      //Â¶ÇÊûú‰∏§Êù°ÁîµÊ¢ØÈÉΩ‰∏ãÈôçÔºåÈÄâÊã©ÊúÄËøëÁöÑ‰∏ÄÂ
             -è∞
 799                  //     if(currentLevel2 > currentLevel1){
 800                  //         liftUp2[0] = 1;
 801                  //     }else{
 802                  //         liftUp1[0] = 1;
 803                  //     }
 804                  // }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   2472    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     38      17
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      6    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
